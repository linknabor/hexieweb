webpackJsonp([4,15],{"136Z":function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var o=void 0,a={name:"coupon",data:function(){return{coupons:this.$route.params.coupons,couponid:this.$route.query.couponid,single:this.$route.query.single,orderId:"",status:"",serviceId:"",agentNo:""}},created:function(){o=this},components:{},computed:{},mounted:function(){},methods:{apply:function(t){1==o.single?o.$router.push({path:"/singlepage",name:"singlepage",query:{},params:{couponitem:t}}):(o.orderId=o.$route.query.orderId,o.status=o.$route.query.status,o.serviceId=o.$route.query.serviceId,o.agentNo=o.$route.query.agentNo,o.amounts=o.$route.query.amounts,o.$router.push({path:"/payment",name:"payment",query:{orderId:o.orderId,status:o.status,serviceId:o.serviceId,agentNo:o.agentNo,amounts:o.amounts,single:o.single,Mask:!0},params:{couponitem:t}}))}}},n={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"coupons"},[e("div",{staticClass:"content"},[e("div",{staticClass:"head"},[t._v("\n            可有优惠券\n        ")]),t._v(" "),t._l(t.coupons,function(s){return e("div",{key:s.id,staticClass:"coupon ov",on:{click:function(e){t.apply(s)}}},[e("div",{staticClass:"fl coupon-right"},[e("span",{staticClass:"f48"},[t._v(t._s(s.amount))]),e("br"),t._v(" "),e("span",{staticClass:"text3 mg1"},[t._v("满任意金额可用")])]),t._v(" "),e("div",{staticClass:"fl coupon-left "},[e("i",{staticClass:"icon_se ",class:{icon_seactive:s.id==t.couponid}}),t._v(" "),e("div",{staticClass:"tSemicircle"}),t._v(" "),e("div",{staticClass:"ov describe"},[e("span",{staticClass:"text1"},[t._v(t._s(s.title))]),t._v(" "),e("span",{staticClass:"text3 describe-h ellipsis2"},[t._v(t._s(s.couponDesc))]),t._v(" "),e("span",{staticClass:"text3"},[t._v(t._s(s.useStartDateStr)+"-"+t._s(s.useEndDateStr))])]),t._v(" "),e("div",{staticClass:"bSemicircle"})])])})],2)])},staticRenderFns:[]};var u=e("VU/8")(a,n,!1,function(t){e("T4yl")},"data-v-55421414",null);s.default=u.exports},T4yl:function(t,s){},a9ow:function(t,s,e){"use strict";(function(t){var o=e("fxnj"),a=e.n(o),n=e("Au9i"),u=(e.n(n),e("136Z"),void 0);s.a={data:function(){return{Mask:this.$route.query.Mask||!1,amount:"|",amounts:0,orderId:this.$route.query.orderId,incolor:!1,status:this.$route.query.status,serviceId:this.$route.query.serviceId,agentNo:this.$route.query.agentNo,couponNum:0,coupon:null,couponDesc:"不使用",coupons:[],couponitem:this.$route.params.couponitem,totalAmount:0}},created:function(){u=this},mounted:function(){u.getcoupons()},components:{},methods:{getfocus:function(){"|"==u.amount&&(u.amount=""),u.incolor=!0},getblur:function(){""==u.amount&&(u.amount="|",u.incolor=!1)},getcoupons:function(){u.receiveData.getData(u,"/coupon/valid4service/"+u.serviceId+"/"+u.agentNo,"res",function(){u.res.success?(u.coupons=u.res.result,u.couponNum=u.coupons.length,u.computeAmount()):alert(u.res.message)})},computeAmount:function(){var t;2==u.$route.query.single&&(u.amount=u.$route.query.amounts,u.amounts=u.$route.query.amounts),void 0!=u.couponitem&&(u.coupon=u.couponitem),null!=u.coupon&&(u.couponDesc="¥"+u.coupon.amount),null==u.coupon?t=u.amounts:u.coupon.usageCondition>u.amounts?u.coupon=null:u.coupon.amount>0&&(t=u.amounts-u.coupon.amount),u.totalAmount=t>0?Number(t).toFixed(2):.01},showCoupons:function(){u.$router.push({path:"/coupon",name:"coupon",query:{single:2,orderId:u.orderId,status:u.status,serviceId:u.serviceId,agentNo:u.agentNo,amounts:u.amounts},params:{coupons:u.coupons}})},showpay:function(){var t=u.amount;""==t||isNaN(t)?alert("请输入正确金额"):(u.amounts=u.amount,u.Mask=!0,u.computeAmount())},onlinePay:function(){if(!u.orderId||u.orderId<=0)alert("页面错误，请到订单详情页重新发起支付！");else{var t=u.amount;""==t||isNaN(t)?alert("请输入正确金额"):u.onlinePays()}},onlinePays:function(){var s;null!=u.coupon&&(s=u.coupon.id),t("#zzmb").show(),u.receiveData.postData(u,"/customService/order/pay?orderId="+u.orderId+"&amount="+u.amount+"&couponId"+s,{},"res",function(){u.res.success?(a.a.config({debug:!1,appId:u.res.result.appid,timestamp:u.res.result.timestamp,nonceStr:u.res.result.noncestr,signature:u.res.result.paysign,jsApiList:["chooseWXPay"]}),a.a.chooseWXPay({timestamp:u.res.result.timestamp,nonceStr:u.res.result.noncestr,package:u.res.result.package,signType:u.res.result.signtype,paySign:u.res.result.paysign,success:function(t){alert("支付成功！"),15==u.status?u.ChangeState():u.$router.push({path:"/appraise",query:{ordersID:u.orderId}})},fail:function(s){t("#zzmb").hide()},cancel:function(t){u.paycancel()}})):(alert(null==u.res.message?"支付请求失败，请稍后重试!":u.res.message),t("#zzmb").hide())})},paycancel:function(){u.receiveData.postData(u,"customService/order/cancelPay?orderId="+u.orderId,null,"res",function(){u.res.success?(alert("支付取消"),t("#zzmb").hide()):(t("#zzmb").hide(),alert(u.res.message))})},ChangeState:function(){u.receiveData.postData(u,"customService/order/notifyPay?orderId="+u.orderId,null,"res",function(){u.res.success?u.$router.push({path:"/appraise",query:{ordersID:u.orderId}}):(u.Mask=!1,alert(null==u.res.message?"系统异常，请稍后重试！":u.res.message),t("#zzmb").hide())})}},computed:{}}}).call(s,e("7t+N"))},aMnh:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var o=e("a9ow"),a={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"repay"},[e("div",{staticClass:"zzmb",attrs:{id:"zzmb"}}),t._v(" "),e("div",{staticClass:"title-top"},[t._v("服务已完工，请支付费用")]),t._v(" "),e("div",{staticClass:"title-mid lite-divider"},[e("div",{staticClass:"title-mid-top"},[t._v("请输入费用（元）")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.amount,expression:"amount"}],staticClass:"title-mid-bottom",class:{tcolor:t.incolor},attrs:{type:"text"},domProps:{value:t.amount},on:{focus:function(s){t.getfocus()},blur:function(s){t.getblur()},input:function(s){s.target.composing||(t.amount=s.target.value)}}})]),t._v(" "),e("div",{staticClass:"main_btn"},[e("div",{staticClass:"btn",on:{click:t.showpay}},[t._v("点击支付")])]),t._v(" "),e("div",{staticClass:"vue-popup"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.Mask,expression:"Mask"}],staticClass:"mask"}),t._v(" "),e("transition",{attrs:{name:"slide"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.Mask,expression:"Mask"}],staticClass:"popup-content"},[e("div",{staticClass:"proup"},[e("div",[e("span",{staticClass:"fs3"},[t._v("¥ ")]),e("span",{staticClass:"fs4 fs4w"},[t._v(t._s(t.totalAmount))])]),t._v(" "),e("div",{staticClass:"couponitem"},[e("span",{staticClass:"fl"},[t._v("订单金额")]),t._v(" "),e("span",{staticClass:"fr"},[t._v("¥"+t._s(t.amounts))])]),t._v(" "),e("div",{staticClass:"couponitem",on:{click:t.showCoupons}},[e("div",{staticClass:"fl"},[e("span",[t._v("优惠券")]),t._v(" "),e("span",{staticClass:" baoyou_desc"},[t._v("  "+t._s(t.couponNum)+"张可用")])]),t._v(" "),e("div",{staticClass:"fr"},[e("span",[t._v(t._s(t.couponDesc))])])]),t._v(" "),e("div",{staticClass:"btn1 btn",on:{click:t.onlinePay}},[t._v("立即支付")])])])])],1)])},staticRenderFns:[]};var n=function(t){e("c9/i")},u=e("VU/8")(o.a,a,!1,n,"data-v-3e2969b6",null);s.default=u.exports},"c9/i":function(t,s){}});