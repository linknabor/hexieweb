webpackJsonp([4],{dGfM:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a,r=t("bOdI"),i=t.n(r),c=t("fxnj"),n=t.n(c),d=t("lbHh"),o=t.n(d),l=void 0,u=(a={data:function(){return{zzshow:!1,ruleId:this.$route.query.ruleId,type:this.$route.query.type,product:{},rule:{limitNumOnce:10,price:0},address:{},checkedAddress:{},count:1,totalAmount:0,order:{},agree:!1}},watch:{},created:function(){l=this},mounted:function(){l.roady()},components:{}},i()(a,"watch",{}),i()(a,"methods",{roady:function(){l.ruleId&&l.type&&l.queryBuyInfo()},initSession4Test:function(){l.receiveData.getData(l,"/initSession4Test/105","Data",function(){})},queryBuyInfo:function(){l.receiveData.getData(l,"/queryBuyInfo/"+l.type+"/"+l.ruleId,"res",function(){l.res.success?(l.product=l.res.result.product,l.rule=l.res.result.rule,l.res.result.address&&(l.checkedAddress=l.res.result.address),l.computeAmount()):alert("订单处理中，请稍后再试！")})},computeAmount:function(){var e;e=l.rule.price*l.count+(l.count<l.rule.freeShippingNum?l.rule.postageFee:0),l.totalAmount=e>0?e.toFixed(2):"0.01"},pay:function(){if(l.agree){var e={ruleId:l.ruleId,count:l.count,orderType:"12",serviceAddressId:l.checkedAddress.id,payType:"2"},s=o.a.get("sectId");if(""==s||"null"==s||0==s||null==s)return alert("您暂未绑定房屋，请前往“我是业主”进行操作，感谢！"),location.href=l.basePageUrl+"wuye/index.html?"+l.common.getoriApp()+"#/myhouse",!1;l.zzshow=!0,l.receiveData.postData(l,"/createOrder",e,"n",function(){l.n.success?(l.order=l.n.result,l.requestPay()):alert(null==l.n.message?"订单创建失败，请稍后重试！":l.n.message)})}},requestPay:function(){l.receiveData.getData(l,"/requestPay/"+l.order.id,"n",function(){l.n.success?(n.a.config({debug:!1,appId:l.n.result.appId,timestamp:l.n.result.timestamp,nonceStr:l.n.result.nonceStr,signature:l.n.result.signature,jsApiList:["chooseWXPay"]}),n.a.chooseWXPay({timestamp:l.n.result.timestamp,nonceStr:l.n.result.nonceStr,package:l.n.result.pkgStr,signType:l.n.result.signType,paySign:l.n.result.signature,success:function(e){l.notifyPaySuccess()},cancel:function(e){alert("支付取消"),l.zzshow=!1}})):(alert(null==l.n.message?"支付请求失败，请稍后重试！":l.n.message),l.zzshow=!1)})},notifyPaySuccess:function(){var e="notifyPayed/"+l.order.id;l.receiveData.getData(l,e,"res",function(){l.res.success?(alert("下单成功！"),l.$router.push({path:"/cardrollsuccess",query:{orderId:l.order.id,type:l.type}})):(l.zzshow=!1,alert(l.res.message))})},cancelPay:function(){l.receiveData.getData(l,"/order/cancelRequestPay/"+l.order.id,"res",function(){l.res.success||alert(l.res.message)})}}),i()(a,"computed",{}),a),v={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"buy"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"load6",attrs:{id:"LoadingBar"}},[t("div",{staticClass:"bounce1"}),e._v(" "),t("div",{staticClass:"bounce2"}),e._v(" "),t("div",{staticClass:"bounce3"})]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"black_overlay",attrs:{id:"fade"}}),e._v(" "),t("div",{staticClass:"zhi"},[t("div",{staticStyle:{background:"white",height:"15px",width:"100%"}},[e._v(" ")]),e._v(" "),t("div",{staticClass:"addr_area"},[t("div",{staticClass:"addr-top"},[e._v(" ")]),e._v(" "),e.checkedAddress.receiveName?t("div",{staticClass:"menu-link fs14 addr_detail"},[t("span",{staticStyle:{color:"#3b3937"},attrs:{id:"infoname"}},[e._v(e._s(e.checkedAddress.receiveName))]),e._v(" "),t("span",{staticStyle:{"margin-left":"15px",color:"#3b3937"},attrs:{id:"infotel"}},[e._v(e._s(e.checkedAddress.tel))]),e._v(" "),t("div",{staticClass:"addr_location",attrs:{id:"infoaddr"}},[e._v(e._s(e.checkedAddress.province)+e._s(e.checkedAddress.city)+e._s(e.checkedAddress.county)+"（"+e._s(e.checkedAddress.xiaoquName)+"）"+e._s(e.checkedAddress.detailAddress))])]):e._e(),e._v(" "),t("div",{staticClass:"addr-f"},[e._v(" ")])]),e._v(" "),t("div",{staticClass:"product_detail"},[t("img",{staticClass:"product_picture",attrs:{src:e.product.smallPicture}}),e._v(" "),t("div",{staticClass:"product_content"},[t("div",{staticClass:"product_name"},[e._v(e._s(e.product.name))]),e._v(" "),t("div",{staticClass:"product_pri_area"},[t("div",{staticClass:"fl fs16 highlight pt5"},[e._v(" ¥"+e._s(e.rule.price)+" ")]),e._v(" "),t("div",{staticClass:"fl fs13",staticStyle:{"margin-left":"10px","padding-top":"7px",color:"#888888"}},[t("del",[e._v("¥"+e._s(e.product.oriPrice))])])])])]),e._v(" "),t("div",{staticClass:"p15  highlight",staticStyle:{height:"36px"}},[t("span",{staticClass:"fl fs15"},[e._v("支付金额")]),e._v(" "),t("span",{staticClass:"fr fs20 mlr10"},[e._v(" ¥ "+e._s(e.totalAmount)+"  ")])]),e._v(" "),t("div",{staticClass:"btn-fixed"},[t("div",{staticClass:"btn-agree"},[t("label",{staticClass:"chendad",class:{"addse adds":1==e.agree},attrs:{for:"checkbox_a6"}}),e._v(" "),t("span",[e._v("已阅读并同意《协议》")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.agree,expression:"agree"}],attrs:{type:"checkbox",id:"checkbox_a6"},domProps:{checked:Array.isArray(e.agree)?e._i(e.agree,null)>-1:e.agree},on:{change:function(s){var t=e.agree,a=s.target,r=!!a.checked;if(Array.isArray(t)){var i=e._i(t,null);a.checked?i<0&&(e.agree=t.concat([null])):i>-1&&(e.agree=t.slice(0,i).concat(t.slice(i+1)))}else e.agree=r}}})]),e._v(" "),t("div",{staticClass:"btn",on:{click:e.pay}},[e._v("立即微信支付")])])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.zzshow,expression:"zzshow"}],staticClass:"zzmb",staticStyle:{display:"none",position:"fixed"},attrs:{id:"zzmb"}})])},staticRenderFns:[]};var p=t("VU/8")(u,v,!1,function(e){t("vX4i")},"data-v-4ad7befa",null);s.default=p.exports},vX4i:function(e,s){}});