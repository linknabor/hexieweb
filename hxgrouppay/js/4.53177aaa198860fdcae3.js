webpackJsonp([4],{dGfM:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,i=s("bOdI"),n=s.n(i),c=s("fxnj"),r=s.n(c),d=s("lbHh"),o=s.n(d),u=void 0,l=(a={data:function(){return{zzshow:!1,ruleId:this.$route.query.ruleId,type:this.$route.query.type,product:{},rule:{limitNumOnce:10,price:0},address:{},checkedAddress:{},count:1,totalAmount:0,order:{}}},watch:{},created:function(){u=this},mounted:function(){u.roady()},components:{}},n()(a,"watch",{}),n()(a,"methods",{roady:function(){u.ruleId&&u.type&&u.queryBuyInfo()},initSession4Test:function(){u.receiveData.getData(u,"/initSession4Test/105","Data",function(){})},queryBuyInfo:function(){u.receiveData.getData(u,"/queryBuyInfo/"+u.type+"/"+u.ruleId,"res",function(){u.res.success?(u.product=u.res.result.product,u.rule=u.res.result.rule,u.res.result.address&&(u.checkedAddress=u.res.result.address),u.computeAmount()):alert("订单处理中，请稍后再试！")})},minusCount:function(){u.count>1&&--u.count&&u.computeAmount()},addCount:function(){u.count<u.rule.limitNumOnce?(u.count++,u.computeAmount()):alert("最多能购买"+u.rule.limitNumOnce+"个")},computeAmount:function(){var t;t=u.rule.price*u.count+(u.count<u.rule.freeShippingNum?u.rule.postageFee:0),u.totalAmount=t>0?t.toFixed(2):"0.01"},pay:function(){var t={ruleId:u.ruleId,count:u.count,orderType:"12",serviceAddressId:u.checkedAddress.id,payType:"2"},e=o.a.get("sectId");if(""==e||"null"==e||0==e||null==e)return alert("您暂未绑定房屋，请前往“我是业主”进行操作，感谢！"),location.href=u.basePageUrl+"wuye/index.html?"+u.common.getoriApp()+"#/myhouse",!1;u.zzshow=!0,u.receiveData.postData(u,"/createOrder",t,"n",function(){u.n.success?(u.order=u.n.result,u.requestPay()):alert(null==u.n.message?"订单创建失败，请稍后重试！":u.n.message)})},requestPay:function(){u.receiveData.getData(u,"/requestPay/"+u.order.id,"n",function(){u.n.success?(r.a.config({debug:!1,appId:u.n.result.appId,timestamp:u.n.result.timestamp,nonceStr:u.n.result.nonceStr,signature:u.n.result.signature,jsApiList:["chooseWXPay"]}),r.a.chooseWXPay({timestamp:u.n.result.timestamp,nonceStr:u.n.result.nonceStr,package:u.n.result.pkgStr,signType:u.n.result.signType,paySign:u.n.result.signature,success:function(t){u.notifyPaySuccess()},cancel:function(t){alert("支付取消"),u.zzshow=!1}})):(alert(null==u.n.message?"支付请求失败，请稍后重试！":u.n.message),u.zzshow=!1)})},notifyPaySuccess:function(){var t="notifyPayed/"+u.order.id;u.receiveData.getData(u,t,"res",function(){u.res.success?(alert("下单成功！"),u.$router.push({path:"/cardrollsuccess",query:{orderId:u.order.id,type:u.type}})):(u.zzshow=!1,alert(u.res.message))})}}),n()(a,"computed",{}),a),v={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"buy"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"load6",attrs:{id:"LoadingBar"}},[s("div",{staticClass:"bounce1"}),t._v(" "),s("div",{staticClass:"bounce2"}),t._v(" "),s("div",{staticClass:"bounce3"})]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"black_overlay",attrs:{id:"fade"}}),t._v(" "),s("div",{staticClass:"zhi"},[s("div",{staticStyle:{background:"white",height:"15px",width:"100%"}},[t._v(" ")]),t._v(" "),s("div",{staticClass:"addr_area"},[s("div",{staticClass:"addr-top"},[t._v(" ")]),t._v(" "),t.checkedAddress.receiveName?s("div",{staticClass:"menu-link fs14 addr_detail"},[s("span",{staticStyle:{color:"#3b3937"},attrs:{id:"infoname"}},[t._v(t._s(t.checkedAddress.receiveName))]),t._v(" "),s("span",{staticStyle:{"margin-left":"15px",color:"#3b3937"},attrs:{id:"infotel"}},[t._v(t._s(t.checkedAddress.tel))]),t._v(" "),s("div",{staticClass:"addr_location",attrs:{id:"infoaddr"}},[t._v(t._s(t.checkedAddress.province)+t._s(t.checkedAddress.city)+t._s(t.checkedAddress.county)+"（"+t._s(t.checkedAddress.xiaoquName)+"）"+t._s(t.checkedAddress.detailAddress))])]):t._e(),t._v(" "),s("div",{staticClass:"addr-f"},[t._v(" ")])]),t._v(" "),s("div",{staticClass:"product_detail"},[s("img",{staticClass:"product_picture",attrs:{src:t.product.smallPicture}}),t._v(" "),s("div",{staticClass:"product_content"},[s("div",{staticClass:"product_name"},[t._v(t._s(t.product.name))]),t._v(" "),s("div",{staticClass:"product_pri_area"},[s("div",{staticClass:"fl fs16 highlight pt5"},[t._v(" ¥"+t._s(t.rule.price)+" ")]),t._v(" "),s("div",{staticClass:"fl fs13",staticStyle:{"margin-left":"10px","padding-top":"7px",color:"#888888"}},[s("del",[t._v("¥"+t._s(t.product.oriPrice))])]),t._v(" "),s("div",{staticClass:"fr fs13",staticStyle:{"padding-top":"7px",color:"#888888"}},[t._v("X "+t._s(t.count))])])])]),t._v(" "),s("div",{staticClass:"line fs15",staticStyle:{height:"50px","line-height":"50px"}},[s("span",[t._v("购买数量")]),t._v(" "),s("span",{staticClass:"fr"},[s("span",{staticClass:"sbtn btn-minus minus-btn-size",class:{active:t.count>1},on:{click:t.minusCount}}),t._v(" "),s("span",{staticClass:"number fs16"},[t._v(t._s(t.count))]),t._v(" "),s("span",{staticClass:"sbtn btn-add active minus-btn-size",on:{click:t.addCount}})])]),t._v(" "),s("div",{staticClass:"p15  highlight",staticStyle:{height:"36px"}},[s("span",{staticClass:"fl fs15"},[t._v("支付金额")]),t._v(" "),s("span",{staticClass:"fr fs20 mlr10"},[t._v(" ¥ "+t._s(t.totalAmount)+"  ")])]),t._v(" "),s("div",{staticClass:"btn-fixed"},[s("div",{staticClass:"btn",on:{click:t.pay}},[t._v("立即微信支付")])])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.zzshow,expression:"zzshow"}],staticClass:"zzmb",staticStyle:{display:"none",position:"fixed"},attrs:{id:"zzmb"}})])},staticRenderFns:[]};var p=s("VU/8")(l,v,!1,function(t){s("ob8u")},"data-v-71ba38f7",null);e.default=p.exports},ob8u:function(t,e){}});